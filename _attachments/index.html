<!DOCTYPE html>
<html>
  <head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>_wal_</title>
    <link rel="stylesheet" href="style/main.css" type="text/css">
	<!--<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">-->


  </head>


  <body>



<a href="/physik04/_design/04/index.html">Home</a>
<div id="search_div" style="float:left;">
<form>
  <input type="text" id="search" name="search"/>
  <input id="submitsearch" type="submit" value="search"/>
</form>
<a id="linkhelper" href='#/search/haloa' style="visibility: hidden;"></a>
</div>

    <div id="tags" style="margin:10px;float:left;"></div>

<div id="content" style="margin:10px; clear:both;" > 

<p>
<ul>
<li><a href="https://github.com/wernwa/qm2-ka-zeppenfeld-ws1011">qm2-ka-zeppenfeld-ws1011</a></li>
<li><a href="https://github.com/wernwa/festk-ka-ustinov-ws1011">festk-ka-ustinov-ws1011</a> | <a href="https://github.com/wernwa/festk-ka-ustinov-ws1011/raw/master/vorles/ustinov_festk_ws1011.pdf"/>PDF </a></li>
</ul>
</p>

<p>  
<h3>Links</h3>
</p>

<ul>
<li><a target="_black" href="#/id/fragen">theo Fragen</a></li>
<li><a target="_black" href="http://de.wikipedia.org/wiki/Naturkonstante">Naturkonstanten</a></li>
</ul>

<p>     E-Mail an: wernwa (at) gmail (dot) com</p>


<div id="basic_path"/>

<div id="google-wetter"></div>

<br>

<i> Webcam am Marktplatz Karlsruhe</i> <a onclick="reload_webcam('webcam_marktplatz'); return false;">[reload]</a>

<div id="webcam_marktplatz">

	<img border="0" style="width: 515px;" src="http://service.ka-news.de/camimage.php?cam=0" alt="Webcam am Marktplatz" />

</div>

<!--<br>
<i> Webcam Physik Hochhaus Karlsruhe </i> <a onclick="reload_webcam('webcam_hochhaus'); return false;">[reload]</a>

<div id="webcam_hochhaus">

	<iframe src="http://www.panoramablick.com/partner_sites/partner.php?cid=1266&nav_id=207&kat_id=1610&l=en" width="600" height="600" scrolling="no" frameborder=0 ></iframe>

</div>-->

</div> <!-- ende div content -->
  </body>



<script src="include/loader.js"></script>
<script src="include/http_get.js"></script>



<!--
<script src="/jslib/mathjax/MathJax.js">
MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]}
  });
</script>
-->






<script type="text/javascript" src="/jslib/outerhtml/jquery.outerhtml.js"></script>
<script type="text/javascript" src="/jslib/form/jquery.form.js"></script>


<script type="text/javascript" charset="utf-8">

/*
$(document).ready(function() {

$("#basic_path").html('<p><a href="#/foo">click for foo</a></p>');
$("#basic_path").bind("foo", function() {
  $(this).html("<p>you went to foo</p>");
});
$("#basic_path").pathbinder("foo", "/foo");


});
*/

// google-wetter
$.ajax({
        type: "GET",
	url: "/ig/api?weather=76133-Germany&hl=de&gweather",
	dataType: "xml",
	success: function(xml) {
 		//$(xml).find('temp_c').each(function(){
 		//	var temp = $(this).attr('data');
		//	$('#google-wetter').html('<b>Karlsruhe Aktuelle Temperatur: '+temp+'</b>');
		//});
		var curr = $(xml).find('current_conditions');
		$('#google-wetter').html('Karlsruhe heute: <b>'+curr.find('temp_c').attr('data')+' °C </b>'+
							curr.find('condition').attr('data')+' '+
							curr.find('humidity').attr('data')+' '+
							curr.find('wind_condition').attr('data')+' '+
						'<img src="http://www.google.com'+curr.find('icon').attr('data')+'"/>');
	}
});


	var search_2_content;
	var load_document;


function reload_webcam(id){

	var timestamp = new Date().getTime();
	if (id=='webcam_marktplatz'){
		$("#"+id).html('<img border="0" style="width: 515px;" src="http://service.ka-news.de/camimage.php?cam=0&forbrowsercacheavoid42='+timestamp+'" alt="Webcam am Marktplatz" />');
	}else{
		 if (id=='webcam_hochhaus'){
			$("#"+id).html('<iframe src="http://www.panoramablick.com/partner_sites/partner.php?cid=1266&nav_id=207&kat_id=1610&l=en&forbrowsercacheavoid42='+timestamp+' width="600" height="600" scrolling="no" frameborder=0  ></iframe>');
		 }
	}

}


$.couch.app(function(app) {
	
	//////////////
	// counter
	////////

	var now = new Date();
	var access_counter_id = 'access_counter_'+(now.getMonth()+1)+'-'+now.getFullYear();

	function save_counter_doc(counter_doc){

		// zähle den userAgent String		
		var userAgent = navigator.userAgent;
		if (counter_doc[userAgent] === undefined){
			counter_doc[userAgent] = 1;
		}else counter_doc[userAgent] += 1;

		// ignoriere die errors die eventuell bei saveDoc auftreten
		var options = {error:function(status, error, reason){}};
		$.couch.db(app.db.name).saveDoc(counter_doc,options);

	}

	$.ajax({
  		url: '/'+app.db.name+'/'+access_counter_id,

		error:function (xhr, ajaxOptions, thrownError){
	        if (xhr.status==404){
				var counter_doc = {_id: access_counter_id, cnt: 1}
				save_counter_doc(counter_doc);
			}
    	    //alert(xhr.statusText);
    	    //alert(xhr.responseText);
    	},
		success: function(data){
			var counter_doc = JSON.parse(data);
			counter_doc.cnt += 1;
			//alert(counter_doc.count);
			save_counter_doc(counter_doc);
		}
	});



	search_2_content  = function(search_str){
		//alert(app.ddoc._id);
			search_str = search_str.toLowerCase();
			$("input#search").val(search_str); 

			$.get('/'+app.db.name+'/'+app.ddoc._id+'/_view/search', 
				{ descending:true
				 ,startkey:'["'+search_str+'",{}]'  
				 ,endkey: '["'+search_str+'",0]'
				,reduce:false
				 
				 //,group:true
				 //,group_level:2
				}, 
				function(data) {
					var req = JSON.parse(data);
					var html = '<div style="margin:20px;"><ul id="navlist">';
					for (var i=0; i<req.rows.length; i++){
						var e = req.rows[i];
						html = html + '<li><a href="#/id/'+e["value"]+'" >' + e["value"]+ '</a></li>';
                    }
					var html = html+'</ul></div>';
  					$('#content').html(html);

  					//$('#content').html(data);
				}
			);

	}
//onclick=\'load_document("'+e["value"]+'"); return false;\'

	load_document = function(id){
        var domain = document.domain;
		if (domain == 'localhost') domain = domain+':5984';
		//var pdf_url = encodeURIComponent('http://'+domain+"/physik/"+id+"/"+id+".pdf");

		


		$.get('/'+app.db.name+'/'+id,
			function(data) {
	
				var doc = JSON.parse(data);
				var posthtml = '';
				if (doc.posthtml !== undefined) posthtml = doc.posthtml;

				//var pdfurl = $('viewpdf',$(posthtml)).attr('url');

				
				$('#content').html('<P>'+posthtml+'</P>');				


				var pdfurl = $('viewpdf').attr('url');
				
				var gviewer = '<iframe id="pdf_iframe" src="http://docs.google.com/viewer?url='+pdfurl+'&embedded=true" style="border: none;width:100%;" onload="function resize_iframe(){var theFrame = $(\'#pdf_iframe\'); theFrame.height($(document).height() - theFrame.offset().top - 50);	} window.onresize = resize_iframe;resize_iframe();"></iframe>';

				$('viewpdf').replaceWith(gviewer);

				/*$.get('/'+db+'/'+design+'/_show/tex2html/'+id,
					function(data) {
						$('#content').html('<P>'+data+'</P>'+'<hr><P>'+posthtml+'</P>');
           			    MathJax.Hub.Queue(["Typeset",MathJax.Hub]);           
					}
				);*/           

			}
		);

	}

	$("#search_div").bind("search", function(e, params) {
		search_2_content(params.id);
	});
	$("#search_div").pathbinder("search", "/search/:id");



	$("#search_div").bind("id", function(e, params) {
		
		load_document(params.id);
		document.title = params.id;

	});
	$("#search_div").pathbinder("id", "/id/:id");

/*	var url = ''+window.location;
	var m = url.match(/#\/search\/(.*)/);
	if (m != null) search_2_content(m[1]);
	m = url.match(/#\/id\/(.*)/);
	if (m != null) load_document(m[1]);*/

	$.pathbinder.begin("/");

	//$.pathbinder.triggerOnPath(window.location);
	
	$('input#submitsearch').click(function(){
		
		var search_str = $('input#search').val().toLowerCase();

		var url = ''+window.location;
		var index_sharp = url.indexOf('#');
		if (index_sharp == -1) 
			url = url + '#/search/'+search_str;
		else
			url = url.substr(0,index_sharp) + '#/search/'+search_str;

		window.location = url;
		
		return false;
	});

	$("#tags").evently({
	  _init : {
	    mustache : "{{#examples}}<a style=\"font-size:{{value}}em;\" href=\"#/search/{{key}}\" >{{key}}</a> | {{/examples}}",
		query : {view: "tags", reduce:true, group:true},
		data: function(data) {

		  // finde Parameter für die Schrift Skalierung
		  var max = 0; 
		  var min = data.rows[0].value;
		  for (var i=0; i<data.rows.length; i++){
			if (data.rows[i].value > max) max = data.rows[i].value;
			if (data.rows[i].value < min) min = data.rows[i].value;
		  }
		  for (var i=0; i<data.rows.length; i++){
			data.rows[i].value = data.rows[i].value*min/max * 2 + 0.3;   //skaliere die jeweilige Schrift
		  }	

		  return {examples: data.rows};
		}
	  }
	  //_changes : function(){ $("#tags").trigger("_init"); }
	},app);


/*
	$("#content").evently({
		search : {
			mustache : "<ul>{{#examples}} <li><a href='#/id/{{value}}'>{{value}}</a></li>{{/examples}}</ul>",
			query : {view: "search"
					 ,descending:true
					 ,startkey:'["'+search_str+'",{}]'  
				 	,endkey: '["'+search_str+'",0]'
					,reduce:false},
			data: function(data) {
			  return {examples: data.rows};
			},	
		}
		

	},app);
*/

	

	
});



  </script>
</html>
